import { getJobStatus } from "../lib/api.js";
import { requireApiKey } from "../lib/config.js";
import * as output from "../lib/output.js";
export async function statusCommand(jobId) {
    requireApiKey();
    const spin = output.spinner("Fetching job status...");
    try {
        const status = await getJobStatus(jobId);
        spin.stop();
        output.label("Job", status.jobId);
        output.label("Status", output.formatStatus(status.status));
        output.label("Prompt", `"${status.prompt}"`);
        output.label("Created", status.createdAt);
        if (status.startedAt) {
            output.label("Started", status.startedAt);
        }
        if (status.completedAt) {
            output.label("Completed", status.completedAt);
        }
        if (status.cancelledAt) {
            output.label("Cancelled", status.cancelledAt);
        }
        if (status.processingTime) {
            output.label("Duration", output.formatDuration(status.processingTime));
        }
        if (status.response) {
            console.log();
            console.log(status.response);
        }
        if (status.error) {
            console.log();
            output.error(status.error);
        }
        if (status.transactions && status.transactions.length > 0) {
            console.log();
            output.dim(`${status.transactions.length} transaction(s) attached.`);
        }
    }
    catch (err) {
        spin.fail("Failed to fetch job status");
        output.error(err.message);
        process.exit(1);
    }
}
//# sourceMappingURL=status.js.map